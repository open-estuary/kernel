/*
 * Huawei Pv660/Hi1610 sas controller device process
 *
 * Copyright 2015 Huawei. <chenjianmin@huawei.com>
 *
 * This file is licensed under GPLv2.
 *
 * This program is free software; you can redistribute it and/or
 * modify it under the terms of the GNU General Public License as
 * published by the Free Software Foundation; version 2 of the
 * License.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307
 * USA
*/

#include "higgs_common.h"
#include "higgs_peri.h"
#include "higgs_stub.h"

/*----------------------------------------------*
 *  * outer variable type define                                *                                 *
 *----------------------------------------------*/

/*----------------------------------------------*
 *    outer function type define                           *
 *----------------------------------------------*/

/*----------------------------------------------*
 * inner function type define                                *
 *----------------------------------------------*/
static void higgs_stub_notify_sfp_event(unsigned long data);

/*----------------------------------------------*
 * global variable                                             *
 *----------------------------------------------*/

/*----------------------------------------------*
 * module  variable                                   *
 *----------------------------------------------*/
static bool debug_mode[HIGGS_MINI_SAS_PORT_COUNT] = { false };
static bool sfp_intr[HIGGS_MINI_SAS_PORT_COUNT];
static enum sal_wire_type sfp_wire_type[HIGGS_MINI_SAS_PORT_COUNT];
static u32 sfp_eeprom_page_select[HIGGS_MINI_SAS_PORT_COUNT];
static const u32 sfp_eeprom_page_shift[HIGGS_SFP_EEPROM_PAGE_COUNT] =
    { 0, 256, 384, 512 };
static const u8 molex_copper_cable_sfp_eeprom[HIGGS_SFP_EEPROM_TOTAL_SIZE] = {
	0x0f, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x38, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x0f, 0x00, 0x23, 0x00, 0x00, 0x30, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x03, 0xa0, 0x4d, 0x6f, 0x6c, 0x65,
	0x78, 0x20, 0x49, 0x6e, 0x63, 0x2e, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x00, 0x00, 0x09, 0x3a,
	0x31, 0x31, 0x31, 0x30, 0x36, 0x38, 0x31, 0x30,
	0x31, 0x33, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
	0x41, 0x20, 0x06, 0x09, 0x00, 0x00, 0x46, 0x1d,
	0x00, 0x00, 0x00, 0x00, 0x32, 0x30, 0x36, 0x36,
	0x33, 0x30, 0x30, 0x30, 0x38, 0x20, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x31, 0x32, 0x30, 0x33,
	0x30, 0x36, 0x20, 0x20, 0x00, 0x00, 0x00, 0x15,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x0f, 0x00, 0x23, 0x00, 0x00, 0x30, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x03, 0xa0, 0x4d, 0x6f, 0x6c, 0x65,
	0x78, 0x20, 0x49, 0x6e, 0x63, 0x2e, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x00, 0x00, 0x09, 0x3a,
	0x31, 0x31, 0x31, 0x30, 0x36, 0x38, 0x31, 0x30,
	0x31, 0x33, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
	0x41, 0x20, 0x06, 0x09, 0x00, 0x00, 0x46, 0x1d,
	0x00, 0x00, 0x00, 0x00, 0x32, 0x30, 0x36, 0x36,
	0x33, 0x30, 0x30, 0x30, 0x38, 0x20, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x31, 0x32, 0x30, 0x33,
	0x30, 0x36, 0x20, 0x20, 0x00, 0x00, 0x00, 0x15,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x0f, 0x00, 0x23, 0x00, 0x00, 0x30, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x3c, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x03, 0xa0, 0x4d, 0x6f, 0x6c, 0x65,
	0x78, 0x20, 0x49, 0x6e, 0x63, 0x2e, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x00, 0x00, 0x09, 0x3a,
	0x31, 0x31, 0x31, 0x30, 0x36, 0x38, 0x31, 0x30,
	0x31, 0x33, 0x20, 0x20, 0x20, 0x20, 0x20, 0x20,
	0x41, 0x20, 0x06, 0x09, 0x00, 0x00, 0x46, 0x1d,
	0x00, 0x00, 0x00, 0x00, 0x32, 0x30, 0x36, 0x36,
	0x33, 0x30, 0x30, 0x30, 0x38, 0x20, 0x20, 0x20,
	0x20, 0x20, 0x20, 0x20, 0x31, 0x32, 0x30, 0x33,
	0x30, 0x36, 0x20, 0x20, 0x00, 0x00, 0x00, 0x15,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};
static const u8 fci_optical_cable_sfp_eeprom[HIGGS_SFP_EEPROM_TOTAL_SIZE] = {
	0x0f, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x20, 0x83,
	0x00, 0x00, 0x7e, 0xd5, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x0a, 0x08, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x0f, 0x00, 0x23, 0x00, 0x00, 0x70, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x03, 0x78, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x14, 0x00, 0x46, 0x43, 0x49, 0x20,
	0x4d, 0x65, 0x72, 0x67, 0x65, 0x4f, 0x70, 0x74,
	0x69, 0x63, 0x73, 0x20, 0x00, 0x00, 0x0a, 0x0d,
	0x31, 0x30, 0x31, 0x32, 0x33, 0x31, 0x39, 0x36,
	0x2d, 0x32, 0x30, 0x30, 0x4c, 0x30, 0x32, 0x30,
	0x41, 0x31, 0x42, 0x68, 0x00, 0x00, 0x46, 0x52,
	0x00, 0x01, 0x04, 0x98, 0x49, 0x4e, 0x31, 0x33,
	0x31, 0x32, 0x2d, 0x42, 0x30, 0x30, 0x30, 0x36,
	0x20, 0x20, 0x20, 0x20, 0x31, 0x33, 0x30, 0x33,
	0x31, 0x39, 0x20, 0x20, 0x00, 0x00, 0x00, 0x21,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x4b, 0x00, 0xfb, 0x00, 0x46, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x8d, 0xcc, 0x75, 0xf8, 0x87, 0x5a, 0x7a, 0x75,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x11, 0x11, 0x33, 0x33,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00
};
#if 0
/*
 * 打桩，软件触发SFP插拔事件
 */
void higgs_stub_simulate_sfp_plug_mini_port(struct higgs_card *ll_card,
					    u32 ll_port_id,
					    enum sal_wire_type wire_type,
					    u32 timeout_ms)
{
	u32 port_id = 0;
	u32 mini_port_id = 0;
	struct timer_list *tmp_timer = NULL;

	/* 定位MINI SAS Port ID */
	if (OK !=
	    higgs_locate_mini_port_id_by_ll_port_id(ll_card, ll_port_id,
						    &mini_port_id)) {
		HIGGS_TRACE(OSP_DBL_MAJOR, 4576,
			    "Card:%d locate mini sas port failed by port:0x%x",
			    ll_card->card_id, ll_port_id);
		return;
	}

	/* 打桩，置为调试模式 */
	if (!debug_mode[mini_port_id])
		debug_mode[mini_port_id] = true;

	/* 标记中断状态  */
	for (port_id = 0; port_id < HIGGS_MINI_SAS_PORT_COUNT; port_id++)
		sfp_intr[port_id] = ((const u32)port_id == mini_port_id);

	/* 修改SFP类型 */
	sfp_wire_type[mini_port_id] = wire_type;

	/* 选择SFP EEPROM Page */
	sfp_eeprom_page_select[mini_port_id] = 0;

	/* 设置定时器, 通知SFP事件 */
	if (0 != timeout_ms) {
		tmp_timer = HIGGS_VMALLOC(sizeof(struct timer_list));
		if (NULL == tmp_timer) {
			HIGGS_TRACE(OSP_DBL_MAJOR, 4576,
				    "Card:%d allocate timer failed",
				    ll_card->card_id);
			return;
		}

		init_timer(tmp_timer);
		tmp_timer->data = (unsigned long)tmp_timer;
		tmp_timer->expires = jiffies + msecs_to_jiffies(timeout_ms);
		tmp_timer->function = higgs_stub_notify_sfp_event;
		add_timer(tmp_timer);
	} else {
		higgs_stub_notify_sfp_event((unsigned long)NULL);
	}
}
#endif

/*
 * stub function , is debug mode or not
 */
bool higgs_stub_in_debug_mode(u32 mini_port_id)
{
	return debug_mode[mini_port_id];
}
#if 0 /* delete by chenqilin */
/*
 * 打桩函数，上报SFP事件
 */
static void higgs_stub_notify_sfp_event(unsigned long data)
{
	u32 mini_port_id;
	u32 ll_port_id;
	u32 logic_port_id;
	struct higgs_card *ll_card;
	u32 gpio_rsp_val;
	struct timer_list *tmp_timer;

	/* 遍历，触发 */
	for (mini_port_id = 0; mini_port_id < HIGGS_MINI_SAS_PORT_COUNT;
	     mini_port_id++) {
		if (false == sfp_intr[mini_port_id])
			continue;

		/* 定位LL Card和逻辑端口号 */
		if (OK !=
		    higgs_locate_ll_card_and_ll_port_id_by_mini_port_id
		    (mini_port_id, &ll_card, &ll_port_id)) {
			HIGGS_TRACE(OSP_DBL_MAJOR, 4576,
				    "Card:%d locate LL card failed by mini sas port:0x%x",
				    0xFF, mini_port_id);
			continue;
		}

		/* 调用SAL_AddEventToWireHandler通知SAL层 */
		gpio_rsp_val = 0xFFFFFFFF;	/* 在PV660/Hi1610平台, GPIO值废弃 */
		logic_port_id =
		    ll_card->sal_card->config.port_logic_id[ll_port_id];
		if (OK !=
		    sal_add_event_to_wire_handler(ll_card->sal_card,
						  gpio_rsp_val, logic_port_id))
			HIGGS_TRACE(OSP_DBL_MAJOR, 4576,
				    "Card:%d add sfp hotplug event failed on port:0x%x",
				    ll_card->card_id, logic_port_id);
		else
			HIGGS_TRACE(OSP_DBL_INFO, 4576,
				    "Card:%d add sfp hotplug event succeeded on port:0x%x",
				    ll_card->card_id, logic_port_id);

		/* 清理中断状态 */
		sfp_intr[mini_port_id] = false;
	}

	/* 清理定时器 */
	tmp_timer = (struct timer_list *)data;
	if (NULL != tmp_timer)
		HIGGS_VFREE(tmp_timer);

	return;
}
#endif 
/*
 *  stub function , check if SFP is in position.
 */
s32 higgs_stub_sfp_on_port(u32 mini_port_id, bool * on_port)
{
	*on_port = ((SAL_ELEC_CABLE == sfp_wire_type[mini_port_id])
		    || (SAL_OPTICAL_CABLE == sfp_wire_type[mini_port_id]));

	return OK;
}

/*
 * stub function , read SFP EEPROM page flip .
 */
s32 higgs_stub_sfp_page_select(u32 mini_port_id, u32 page_sel)
{
	HIGGS_ASSERT(mini_port_id < HIGGS_MINI_SAS_PORT_COUNT, return ERROR);
	HIGGS_ASSERT(page_sel < HIGGS_SFP_EEPROM_PAGE_COUNT, return ERROR);

	sfp_eeprom_page_select[mini_port_id] = page_sel;
	return OK;
}

/*
 * stub function , read SFP EEPROM 
 */
s32 higgs_stub_read_sfp_eeprom(u32 mini_port_id, u8 * page, u32 len, u32 offset)
{
	u32 page_sel;
	u32 tmp_offset;
	s32 ret;

	HIGGS_ASSERT(NULL != page, return ERROR);
	HIGGS_ASSERT(mini_port_id < HIGGS_MINI_SAS_PORT_COUNT, return ERROR);

	page_sel = sfp_eeprom_page_select[mini_port_id];
	switch (sfp_wire_type[mini_port_id]) {
	case SAL_ELEC_CABLE:
		tmp_offset = offset;	/*There is only page0 with cable  */
		HIGGS_ASSERT((tmp_offset + len) <= HIGGS_SFP_EEPROM_TOTAL_SIZE,
			     return ERROR);
		memcpy(page, molex_copper_cable_sfp_eeprom + tmp_offset, len);
		ret = OK;
		break;
	case SAL_OPTICAL_CABLE:
		tmp_offset = sfp_eeprom_page_shift[page_sel];
		HIGGS_ASSERT((tmp_offset + len) <= HIGGS_SFP_EEPROM_TOTAL_SIZE,
			     return ERROR);
		memcpy(page, fci_optical_cable_sfp_eeprom + tmp_offset, len);
		ret = OK;
		break;
	case SAL_IDLE_WIRE:
	case SAL_WIRE_TYPE_BUTT:
	default:
		ret = ERROR;
		break;
	}

	return ret;
}

/*
 * stub function , read SFP EEPROM 
 */
s32 higgs_stub_read_copper_cable_eeprom(u8 * page, u32 len, u32 offset)
{
	HIGGS_ASSERT(NULL != page, return ERROR);
	HIGGS_ASSERT((offset + len) <= HIGGS_SFP_REGISTER_PAGE_LENGEH,
		     return ERROR);

	memcpy(page, molex_copper_cable_sfp_eeprom + offset, len);

	return OK;
}

/*
 * stub function , light led .
 */
s32 higgs_stub_led_ctrl(u32 mini_port_id, enum sal_led_op_type led_op)
{
	HIGGS_TRACE(OSP_DBL_INFO, 4576,
		    "Card:%d StubLedCtrl, mini sas port:0x%x led operaton: 0x%x",
		    0xFF, mini_port_id, led_op);
	return OK;		/* didn't light led in actual.*/
}

/*
 * stub function , fill default LL CARD CONFIG
 */
void higgs_stub_fill_default_config_info(struct higgs_card *ll_card)
{
	struct higgs_config_info *cfg_info;

	/* parameter check */
	HIGGS_ASSERT(NULL != ll_card, return);

	/* fill */
	cfg_info = &ll_card->card_cfg;
	cfg_info->work_mode = 2;
	cfg_info->smp_tmo = 3;
	cfg_info->jam_tmo = 0;
	cfg_info->numinboundqueues = 4;
	cfg_info->numoutboundqueues = 4;
	cfg_info->ibqueue_num_elements = 4096;
	cfg_info->obqueue_num_elements = 4096;
	cfg_info->dev_queue_depth = 32;
	cfg_info->max_targets = 1024;
	cfg_info->max_canqueue = 4096;
	cfg_info->max_active_io = 4096;
	cfg_info->hwint_coal_timer = 0;
	cfg_info->hwint_coal_count = 0;
	cfg_info->ncq_switch = 0;
	cfg_info->phy_link_rate[0] = 0x04;
	cfg_info->phy_link_rate[1] = 0x04;
	cfg_info->phy_link_rate[2] = 0x04;
	cfg_info->phy_link_rate[3] = 0x04;
	cfg_info->phy_link_rate[4] = 0x04;
	cfg_info->phy_link_rate[5] = 0x04;
	cfg_info->phy_link_rate[6] = 0x04;
	cfg_info->phy_link_rate[7] = 0x04;
	cfg_info->phy_addr_high[0] = 0xA0020304;
	cfg_info->phy_addr_high[1] = 0xA0020304;
	cfg_info->phy_addr_high[2] = 0xA0020304;
	cfg_info->phy_addr_high[3] = 0xA0020304;
	cfg_info->phy_addr_high[4] = 0xA0020304;
	cfg_info->phy_addr_high[5] = 0xA0020304;
	cfg_info->phy_addr_high[6] = 0xA0020304;
	cfg_info->phy_addr_high[7] = 0xA0020304;
	cfg_info->phy_addr_low[0] = 0x05060708;
	cfg_info->phy_addr_low[1] = 0x05060708;
	cfg_info->phy_addr_low[2] = 0x05060708;
	cfg_info->phy_addr_low[3] = 0x05060708;
	cfg_info->phy_addr_low[4] = 0x05060708;
	cfg_info->phy_addr_low[5] = 0x05060708;
	cfg_info->phy_addr_low[6] = 0x05060708;
	cfg_info->phy_addr_low[7] = 0x05060708;
	cfg_info->biterr_stop_threshold = 10;
	cfg_info->biterr_interval_threshold = 5;
	cfg_info->biterr_routine_time = 1;
	cfg_info->biterr_routine_count = 20;
	cfg_info->port_bitmap[0] = 0x000f;
	cfg_info->port_bitmap[1] = 0x00f0;
	cfg_info->port_bitmap[2] = 0x0000;
	cfg_info->port_bitmap[3] = 0x0000;
	cfg_info->port_bitmap[4] = 0x0000;
	cfg_info->port_bitmap[5] = 0x0000;
	cfg_info->port_bitmap[6] = 0x0000;
	cfg_info->port_bitmap[7] = 0x0000;
	cfg_info->phy_g3_cfg[0] = 0x00fd34f7;
	cfg_info->phy_g3_cfg[1] = 0x00fd34f7;
	cfg_info->phy_g3_cfg[2] = 0x00fd34f7;
	cfg_info->phy_g3_cfg[3] = 0x00fd34f7;
	cfg_info->phy_g3_cfg[4] = 0x00fd34f7;
	cfg_info->phy_g3_cfg[5] = 0x00fd34f7;
	cfg_info->phy_g3_cfg[6] = 0x00fd34f7;
	cfg_info->phy_g3_cfg[7] = 0x00fd34f7;
	cfg_info->port_mini_id[0] = 0xff;
	cfg_info->port_mini_id[1] = 0xff;
	cfg_info->port_mini_id[2] = 0xff;
	cfg_info->port_mini_id[3] = 0xff;
	cfg_info->port_mini_id[4] = 0xff;
	cfg_info->port_mini_id[5] = 0xff;
	cfg_info->port_mini_id[6] = 0xff;
	cfg_info->port_mini_id[7] = 0xff;

	/* tailor-made item  */
	switch (ll_card->card_id) {
	case 0:
		cfg_info->port_mini_id[0] = 0;
#ifdef FPGA_VERSION_TEST
		cfg_info->port_bitmap[1] = 0x0000;	/*Only  PHY 0-3, single port. */
		cfg_info->phy_link_rate[0] = 0x01;	/* 1.5G */
		cfg_info->phy_link_rate[1] = 0x01;
		cfg_info->phy_link_rate[2] = 0x01;
		cfg_info->phy_link_rate[3] = 0x01;
		cfg_info->phy_link_rate[4] = 0x01;
		cfg_info->phy_link_rate[5] = 0x01;
		cfg_info->phy_link_rate[6] = 0x01;
		cfg_info->phy_link_rate[7] = 0x01;
		cfg_info->phy_g3_cfg[0] = 0x00000000;
		cfg_info->phy_g3_cfg[1] = 0x00000000;
		cfg_info->phy_g3_cfg[2] = 0x00000000;
		cfg_info->phy_g3_cfg[3] = 0x00000000;
		cfg_info->phy_g3_cfg[4] = 0x00000000;
		cfg_info->phy_g3_cfg[5] = 0x00000000;
		cfg_info->phy_g3_cfg[6] = 0x00000000;
		cfg_info->phy_g3_cfg[7] = 0x00000000;
#endif
		break;
	case 1:
		break;
	default:
		break;
	}

}
